@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    color-scheme: light;

    /* Light surface tokens */
    --color-bg-canvas: 224 40% 97%;
    --color-bg-subtle: 226 45% 94%;
    --color-bg-card: 0 0% 100%;
    --color-bg-elevated: 226 48% 98%;
    --color-bg-hover: 226 82% 96%;
    --color-bg-pressed: 228 88% 90%;

    --color-fg-default: 234 44% 14%;
    --color-fg-muted: 228 22% 44%;
    --color-fg-subtle: 228 18% 60%;
    --color-fg-on-accent: 0 0% 100%;

    --color-accent-default: 258 92% 64%;
    --color-accent-hover: 258 92% 60%;
    --color-accent-pressed: 258 92% 52%;
    --color-accent-subtle: 258 92% 94%;
    --color-accent-muted: 258 75% 86%;
    --color-accent-glow: 258 100% 72%;
    --color-accent-gradient-from: 258 96% 68%;
    --color-accent-gradient-to: 281 96% 67%;

    --color-stroke-divider: 228 24% 84%;
    --color-stroke-strong: 226 24% 70%;
    --color-stroke-focus: 258 92% 64%;

    --color-status-success: 146 62% 40%;
    --color-status-warning: 35 96% 54%;
    --color-status-danger: 346 82% 56%;
    --color-status-info: 214 94% 68%;

    --color-overlay-soft: 228 28% 88%;
    --color-overlay-strong: 258 92% 64%;

    --color-glass-surface: hsla(0, 0%, 100%, 0.72);
    --color-glass-hover: hsla(226, 52%, 96%, 0.82);
    --color-glass-border: hsla(228, 60%, 78%, 0.45);

    --shadow-color: 227 32% 12%;
    --shadow-glow: 264 96% 70%;
  }

  .dark {
    color-scheme: dark;

    --color-bg-canvas: 246 44% 6%;
    --color-bg-subtle: 248 44% 10%;
    --color-bg-card: 248 36% 14%;
    --color-bg-elevated: 248 38% 16%;
    --color-bg-hover: 248 38% 18%;
    --color-bg-pressed: 248 36% 22%;

    --color-fg-default: 220 40% 96%;
    --color-fg-muted: 225 28% 72%;
    --color-fg-subtle: 226 22% 52%;
    --color-fg-on-accent: 0 0% 100%;

    --color-accent-default: 263 100% 70%;
    --color-accent-hover: 265 100% 64%;
    --color-accent-pressed: 268 100% 58%;
    --color-accent-subtle: 268 86% 20%;
    --color-accent-muted: 266 78% 32%;
    --color-accent-glow: 263 100% 72%;
    --color-accent-gradient-from: 260 100% 66%;
    --color-accent-gradient-to: 284 100% 68%;

    --color-stroke-divider: 244 26% 24%;
    --color-stroke-strong: 244 30% 36%;
    --color-stroke-focus: 265 100% 64%;

    --color-status-success: 146 62% 50%;
    --color-status-warning: 35 96% 60%;
    --color-status-danger: 346 82% 64%;
    --color-status-info: 214 94% 70%;

    --color-overlay-soft: 244 40% 16%;
    --color-overlay-strong: 263 100% 64%;

    --color-glass-surface: hsla(247, 42%, 14%, 0.68);
    --color-glass-hover: hsla(250, 48%, 22%, 0.74);
    --color-glass-border: hsla(265, 70%, 52%, 0.45);

    --shadow-color: 246 42% 10%;
    --shadow-glow: 264 100% 72%;
  }

  * {
    @apply border-stroke-divider;
  }

  html {
    @apply scroll-smooth;
  }

  /* Use the app-level main container for scrolling; prevent document scroll */
  html,
  body,
  #__next {
    height: 100%;
    overflow: hidden !important;
  }

  body {
    @apply bg-bg-canvas text-fg-default font-sans antialiased;
    min-height: 100vh;
  background-image: radial-gradient(circle at top, hsl(var(--color-accent-gradient-from) / 0.12), transparent 55%), radial-gradient(circle at 20% 20%, hsl(var(--color-accent-gradient-to) / 0.08), transparent 45%);
    background-attachment: fixed;
    font-feature-settings: 'rlig' 1, 'calt' 1;
  }

  ::selection {
    background-color: hsl(var(--color-accent-default) / 0.24);
    color: hsl(var(--color-fg-on-accent));
  }

  /* Focus outline */
  *:focus-visible {
    outline: 2px solid hsl(var(--color-stroke-focus));
    outline-offset: 3px;
    box-shadow: 0 0 0 6px hsl(var(--color-stroke-focus) / 0.18);
  }

  /* Reduce motion for accessibility */
  @media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
    }
  }
}

@layer components {
  /* Loading spinner with Fluent design */
  .spinner {
    @apply animate-spin rounded-full h-4 w-4 border-2 border-stroke-divider border-t-accent;
  }

  /* Text truncation utility */
  .line-clamp-3 {
    line-clamp: 3;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
}

@layer utilities {
  /* Glassmorphism helpers */
  .glass-panel {
    background: var(--color-glass-surface);
    border: 1px solid var(--color-glass-border);
    backdrop-filter: blur(20px);
  }

  .glass-panel:hover {
    background: var(--color-glass-hover);
  }

  .focus-ring {
    box-shadow: 0 0 0 3px hsl(var(--color-stroke-focus) / 0.2);
  }

  /* Custom scrollbar styling (applied via .custom-scrollbar) */
  .custom-scrollbar {
    scrollbar-width: thin; /* Firefox */
    scrollbar-color: hsl(var(--color-stroke-divider)) transparent; /* Firefox */
  }

  .dark .custom-scrollbar {
    scrollbar-color: hsl(var(--color-stroke-strong)) transparent;
  }

  .custom-scrollbar::-webkit-scrollbar {
    width: 10px;
    height: 10px;
  }

  .custom-scrollbar::-webkit-scrollbar-track {
    background: transparent;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb {
    background: hsl(var(--color-stroke-divider));
    border-radius: 8px;
    border: 2px solid hsl(var(--color-bg-canvas));
    transition: background-color 120ms ease, border-color 120ms ease;
  }

  .dark .custom-scrollbar::-webkit-scrollbar-thumb {
    background: hsl(var(--color-stroke-strong));
    border: 2px solid hsl(var(--color-bg-subtle));
  }

  .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background: hsl(var(--color-accent-muted));
    border-color: hsl(var(--color-bg-card));
  }

  .dark .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background: hsl(var(--color-accent-muted));
    border-color: hsl(var(--color-bg-elevated));
  }

  /* Narrow variant if needed */
  .custom-scrollbar.thin::-webkit-scrollbar {
    width: 6px;
  }

  /* Utility to visually hide scrollbars while preserving scroll behavior */
  .hide-scrollbar {
    -ms-overflow-style: none; /* IE and Edge */
    scrollbar-width: none; /* Firefox */
  }
  .hide-scrollbar::-webkit-scrollbar {
    display: none; /* Safari and Chrome */
  }
}